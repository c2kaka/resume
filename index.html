<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <link rel="stylesheet" href="./style.css">
  <script src="./js/iconfont.js"></script>
  <style>
    .icon {
      width: 1em;
      height: 1em;
      vertical-align: -0.15em;
      fill: currentColor;
      overflow: hidden;
    }

    .site-welcome{
      display: none;
      background: #888;
      justify-content: center;
      align-items: center;
      position: fixed;
      top:0;
      left: 0;
      height: 100%;
      width: 100%;
      z-index: 1;
    }

    .site-welcome.active{
      display: flex;
    }

    .loading{
      height: 200px;
      width: 200px;
      position: relative;
    }

    .loading::before,.loading::after{
      content: "";
      position: absolute;
      height: 0;
      width: 0;
      top:0;
      left:0;
      right: 0;
      bottom: 0;
      margin: auto;
      border-radius: 50%;
      background: black;
      animation: loadingAnimation 1.5s linear infinite;
    }

    .loading::after{
      animation-delay: 0.75s;
    }

    @keyframes loadingAnimation {
      0%{
        height: 0;
        width: 0;
        opacity: 1;
      }

      100%{
        height: 100px;
        width: 100px;
        opacity: 0;
      }
    }

  </style>
  <title>欧阳帆 个人简历</title>
</head>

<body>
<!--  <div class="site-welcome active" id="siteWelcome">-->
<!--    <div class="loading"></div>-->
<!--  </div>-->
  <div class="topNavBar" id="topNavBar" >
    <div class="topNavBar-inner clearfix">
      <a class="logo" href="#" alt="logo" style="float: left; ">
        <span class="rs">RS</span><span class="card">card</span>
      </a>
      <nav class="menu" style="float: right;">
        <ul class="clearfix">
          <li><a href="#siteAbout">关于</a></li>
          <li class="menuTrigger">
            <a href="#siteSkills">技能</a>
            <ul class="subMenu">
              <li>技能1</li>
              <li>技能2</li>
              <li>技能3</li>
            </ul>
          </li>
          <li class="menuTrigger">
            <a href="#sitePortfolio">作品</a>
            <ul class="subMenu">
              <li>作品1</li>
              <li>作品2</li>
              <li>作品3</li>
            </ul>
          </li>
          <li><a href="#">博客</a></li>
          <li><a href="#">日历</a></li>
          <li><a href="#">联系方式</a></li>
          <li><a href="#">其他</a></li>
        </ul>
      </nav>
    </div>
  </div>

  <div class="banner">
    <div class="mask"></div>
  </div>

  <main>
    <div data-x id="siteAbout" class="userCard">
      <div class="picAndText clearfix">
        <div class="pic">
          <img src="./img/avatar.jpg" alt="头像" />
        </div>
        <div class="text">
          <div class="profile">
            <span class="welcome">Hello<span class="triangle"></span></span>
            <h1>欧阳帆</h1>
            <p>前端开发工程师</p>
            <hr />
            <dl>
              <dt>年龄</dt>
              <dd>27</dd>
              <dt>所在城市</dt>
              <dd>杭州</dd>
              <dt>邮箱</dt>
              <dd>ouyangfanseu@gmail.com</dd>
              <dt>手机</dt>
              <dd>13812345678</dd>
            </dl>
          </div>
        </div>
      </div>

      <footer class="media">
        <a href="#">
          <svg class="icon" aria-hidden="true">
            <use xlink:href="#icon-github"></use>
          </svg>
        </a>
        <a href="#">
          <svg class="icon" aria-hidden="true">
            <use xlink:href="#icon-qq"></use>
          </svg>
        </a>
        <a href="#">
          <svg class="icon" aria-hidden="true">
            <use xlink:href="#icon-wechat"></use>
          </svg>
        </a>
        <a href="#">
          <svg class="icon" aria-hidden="true">
            <use xlink:href="#icon-weibo"></use>
          </svg>
        </a>
      </footer>
    </div>

    <p class="downloadWrapper">
      <a class="download" href="./resume.pdf" target="_blank" class="button">下载PDF简历</a>
    </p>

    <p class="selfIntroduction">
      欧阳帆， 前端开发工程师<br />
      技能：前端开发，Java 开发，Node.js 开发
    </p>
  </main>

  <section data-x id="siteSkills" class="skills">
    <h2>技能</h2>
    <ol class="clearfix">
      <li>
        <h3>HTML 5 &amp; CSS 3</h3>
        <div class="progressBar">
          <div class="progress"></div>
        </div>
      </li>
      <li>
        <h3>JavaScript</h3>
        <div class="progressBar">
          <div class="progress"></div>
        </div>
      </li>
      <li>
        <h3>jQuery</h3>
        <div class="progressBar">
          <div class="progress"></div>
        </div>
      </li>
      <li>
        <h3>Vue.js</h3>
        <div class="progressBar">
          <div class="progress"></div>
        </div>
      </li>
      <li>
        <h3>React.js</h3>
        <div class="progressBar">
          <div class="progress"></div>
        </div>
      </li>
      <li>
        <h3>Node.js</h3>
        <div class="progressBar">
          <div class="progress"></div>
        </div>
      </li>
    </ol>
  </section>

  <section data-x id="sitePortfolio" class="portfolio">
    <h2>作品集</h2>
    <nav>
      <ol class="clearfix">
        <li id="portfolioAll">所有</li>
        <li id="portfolioFrameWork">框架</li>
        <li id="portfolioNative">原生JS&amp;CSS</li>
      </ol>
      <div id="portfolioBar" class="bar state-1">
        <div class="bar-inner"></div>
      </div>
      <script>
        portfolioAll.onclick=function(){
          portfolioBar.className="bar state-1";
        }

        portfolioFrameWork.onclick=function(){
          portfolioBar.className="bar state-2";
        }

        portfolioNative.onclick=function(){
          portfolioBar.className="bar state-3";
        }
      </script>
    </nav>

    <div class="works" style="height: 597px;">
      <div class="big" style="top: 0; left:0;">
        <img src="./img/1.jpg" alt="作品1">
      </div>
      <div class="small" style="top: 0; left: 645px;">
        <img src="./img/2.jpg" alt="作品2">
      </div>
      <div class="small" style="top: 298px; left:645px;">
        <img src="./img/3.jpg" alt="作品3">
      </div>
    </div>
  </section>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/17.3.0/Tween.min.js"></script>
  <script>
    // setTimeout(function () {
    //   siteWelcome.classList.remove("active");
    // },888);
    let specialTags=document.querySelectorAll("[data-x]");
    for (let i=0;i<specialTags.length;i++){
      specialTags[i].classList.add("offset");
    }

    findClosest();

    window.onscroll=function () {
      window.scrollY > 0 ? topNavBar.classList.add("sticky") : topNavBar.classList.remove("sticky");
      findClosest();
    };

    /**
     * 找到离当前视口最近的模块
     */
    function findClosest(){
        //find all elements with data-x
      let datas=document.querySelectorAll("[data-x]");
      let windowScrollY=window.scrollY;
      let minIndex=0; //init minIndex as 0
      for (let i=1;i<datas.length;i++){
        let currentDistance=Math.abs(datas[i].offsetTop-windowScrollY);
        let minDistance=Math.abs(datas[minIndex].offsetTop-windowScrollY);
        if(currentDistance<minDistance){
          minIndex=i;
        }
      }
      datas[minIndex].classList.remove("offset");
      let minSectionId=datas[minIndex].id;
      let highLightLi=document.querySelector('a[href="#'+minSectionId+'"]').parentNode;
      let brothersAndMe=highLightLi.parentNode.children;
      for(let i=0;i<brothersAndMe.length;i++){
        brothersAndMe[i].classList.remove("highLight");
      }
      highLightLi.classList.add("highLight");
    }


    let menuTriggers = document.querySelectorAll("nav.menu > ul > li");
    for(let i=0;i<menuTriggers.length;i++){
      menuTriggers[i].onmouseenter = function (e) {
        e.currentTarget.classList.add("active");
      }

      menuTriggers[i].onmouseleave = function (e) {
        e.currentTarget.classList.remove("active");
      }
    }

    let aTags = document.querySelectorAll("nav.menu > ul > li > a");
    for (let i=0;i<aTags.length;i++){
      aTags[i].onclick = function (e) {
        e.preventDefault();
        let href=e.currentTarget.getAttribute("href");
        let div=document.querySelector(href);
        let currentY=window.scrollY;
        let targetY=div.offsetTop-80;
        let distance=targetY-currentY;
        // Setup the animation loop.
        function animate(time) {
          requestAnimationFrame(animate);
          TWEEN.update(time);
        }
        requestAnimationFrame(animate);

        let duration=Math.abs((distance/100)*200 > 400 ? 400 : (distance/100)*200);
        let coords = { y: currentY }; // Start at currentY
        let tween = new TWEEN.Tween(coords) // Create a new tween that modifies 'coords'.
                .to({ y: targetY }, duration) // Move to targetY in duration
                .easing(TWEEN.Easing.Quadratic.InOut) // Use an easing function to make the animation smooth.
                .onUpdate(function() { // Called after tween.js updates 'coords'.
                  window.scrollTo(0,coords.y);
                })
                .start(); // Start the tween immediately.
      }
    }
  </script>
</body>

</html>